/*

 JSParsec - A parser combinator library for JavaScript

 Version: 1.0.1

 http://code.google.com/p/jsparsec/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators and the memoization is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec:
 http://www.haskell.org/haskellwiki/Parsec

*/
(function(){function wa(a){function b(){var c=H(arguments);return c.length>=(a._length===undefined?a.length:a._length)?a.apply(null,c):function(){return b.apply(null,c.concat(H(arguments)))}}return b}function Kb(a){return function(){return a}}function xa(a){return Dc.call(a)=="[object Array]"}function Wa(a){return a!==C}function H(a,b){return Ec.call(a,b||0)}function Xa(a,b,c){for(var d=0,e=c.length;d<e;++d)b=a(b,c[d]);return b}function ya(a,b,c){for(var d=c.length-1;d>-1;--d)b=a(c[d],b);return b}
function F(a,b){for(var c=[],d=0,e=b.length;d<e;++d)c[d]=a(b[d],d);return c}function Lb(a,b){for(var c=[],d=0,e=a.length;d<e;++d)b(a[d])&&c.push(a[d]);return c}function Ya(a,b){var c=a.length;if(!c)return-1;for(var d=0;d<c;d++)if(a[d]===b)return d;return-1}function Mb(a,b){var c=a.length;if(!c)return-1;for(c=c-1;c>-1;--c)if(a[c]===b)return c;return-1}function Za(a,b){for(var c=[],d=0,e=Math.min(a.length,b.length);d<e;++d)c[d]=[a[d],b[d]];return c}function $a(a){var b=typeof a;if(b=="object")return a.sort();
if(b=="string")return H(a).sort().join("")}function Na(a,b){b=b===C?[]:b;var c=a[0],d=H(a,1);return!a.length?[]:Oa(c,b)?Na(d,b):I(c,Na(d,I(c,b)))}function Nb(a,b,c){if(c.Nothing)return a;if(c.Just)return b(c[0])}function Ob(a,b){return a===b?Fa.EQ:a<=b?Fa.LT:Fa.GT}function D(a,b){for(var c in b)a[c]=b[c];return a}function Pb(a,b){return function(){return a(b.apply(null,arguments))}}function Qb(a,b){return function(c){var d=H(arguments,1);d.unshift(b(c));return a.apply(null,d)}}function ab(a){return function(b,
c){return a(c,b)}}function I(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return[a].concat(b)}function bb(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return a+b.join("")}function cb(a,b){for(var c=[],d=0;d<a;++d)c[d]=b;return c}function Rb(a){return-a}function db(a){return!a.length}function Oa(a,b){return(b.indexOf?b.indexOf(a):Ya(b,a))!=-1}function eb(a){return/^\s$/.test(a)}function Sb(a){return a.toUpperCase()==a}function Tb(a){return a.toLowerCase()==a}function Ub(a){return/^\w$/.test(a)}
function fb(a){return/^\w$/.test(a)&&/^\D$/.test(a)}function Vb(a){return/^\d$/.test(a)}function gb(a){return/^[0-9A-Fa-f]$/.test(a)}function Wb(a){return/^[0-7]$/.test(a)}function hb(a){if(!gb(a))throw"Data.Char.digitToInt: not a digit "+a;return parseInt(a,16)}function Fc(a,b){return{indexOf:function(c){return c>=a&&c<=b?true:-1},toString:function(){return"range("+a+", "+b+")"}}}function Gc(a){return a[0]}function Hc(a){return a[1]}function Ic(a){return function(b){return a(b[0],b[1])}}function Jc(a,
b){var c=b.length;if(!c)return R.Nothing;for(var d=0;d<c;++d)if(b[d][0]===a)return R.Just(b[d][1]);return R.Nothing}function Kc(){var a,b;F(function(c){b=c.split(".");a=window[b[0]]=window[b[0]]||{};F(function(d){a=a[d]=a[d]||{}},b.slice(1))},arguments);return a}function Xb(){}function Lc(a,b){if(!/^[0-9]$/.test(b))return b;if(typeof a!="object")return b;var c=0;for(var d in a){if(a.hasOwnProperty(d)&&c==b)return d;c++}return-1}function Pa(){}function Yb(a){return function(){var b=[],c=this._recordset;
if(c&&!xa(c)){for(var d in c){var e=a?c[d].name||c[d]:this[d];if(!a&&e instanceof Function)e=e.constructor!=Function?e.constructor.name:"Function("+e.name+")";b.push(d+" :: "+e)}c=cb(this._dataConstructor.length+2," ").join("");b="{"+b.join("\n"+c+",")+"\n"+c+"}"}else{for(d=0;d in this;d++)b.push(a?c[d].name||c[d]:this[d]);b=b.join(" ")}return"("+this._dataConstructor+(b?" ":"")+b+")"}}function ea(a,b){function c(j,i){function o(z,u){var A=z instanceof Xb,S=A?u:H(arguments),L=new a,J=0;L.constructor=
a;L._recordset=p&&i[0]||i;L._dataConstructor=j;L.update=function(fa){var Z={};for(var P in i[0]){Z[P]=this[P];if(P in fa)Z[P]=fa[P]}return o(za,Z)};L[j]=true;if(S!==C)for(var M in S)if(S.hasOwnProperty(M)&&M!=j){if(A&&i&&p)if(!(M in i[0]))throw"The accessor '"+M+"' is not defined for the data constructor '"+j+"'";var $=Lc(i[0],M),aa=S[J]!==undefined?S[J]:S[$],U=p?i[0][$]:i[J];if(U.name&&!(U==aa.constructor||aa instanceof U))throw"Type error: expecting '"+U.name+"' instead of '"+aa.constructor.name+
"' in the argument '"+($||J)+"' of the data constructor '"+j+"' of type '"+a.name+"'";L[$]=L[J]=L[M]=S[M];J++}else if(M==j)throw"Accessor has the same name as the data constructor: '"+j+"'";return L}var p=i&&typeof i[0]=="object";return o}if(a.constructors)throw"Type constructor has been already defined: '"+a.name+"'";a.constructors=b;a.prototype=new Pa;for(var d=0,e=b.length;d<e;++d){var g=typeof b[d]!="object",h=g?b[d]:b[d][0];if(h in a)throw"The name of the data constructor ("+h+") is invalid!";
a[h]=g?c(h)():c(h,H(b[d],1));if(!g)a[h]._length=H(b[d],1).length}}function R(){}function Fa(){}function Aa(){}function ba(a){return["l",a]}function oa(a){return["r",a]}function Zb(a){return["x",a]}function Mc(a){if(a)if(!a._String){var b=Ba[a];if(a._Op&&!b)return"l";return b&&(b.fixity[0]||"l")}}function Nc(a){if(a)if(!a._String){var b=Ba[a];if(a._Op&&!b)return 9;return b&&(Wa(b.fixity[1])?b.fixity[1]:9)}}function ib(a,b,c){var d;if(a[b]._Op){delete a[b]._Op;d=a[b]}else d=Ba[a[b]].func;d=d(a[b-1],
a[b+1]);a.splice(b-1,3,d);return ga(a,c)}function Oc(a){a._Array=true;return a}function Pc(a){a=new String(a);a._String=true;return a}function Qc(a){a._Op=true;return a}function ga(a,b){a=F(function(i){if(i&&i._Array){delete i._Array;return i}return xa(i)?ga(i,b):i&&i.CallStream?i.resolve(b):i},a);if(b)a=F(function(i){return i instanceof jb?b:i},a);for(var c=[],d=[],e=0,g=a.length;e<g;++e){var h=a[e],j=false;if(Ba[h])j=true;if(h&&h._String){j=false;h=h.toString()}if(h&&h._Op)j=true;if(!j&&e!=g-1)c.push(h);
else{e==g-1&&c.push(h);c=c.length>1?c[0].apply(null,c.slice(1)):c[0];d.push(c);e!=g-1&&d.push(h);c=[]}}a=d;d=F(Mc,a);g=F(Nc,a);h=Lb(g,Wa).sort().pop();e=Ya(g,h);g=Mb(g,h);return d[e]=="l"?ib(a,e,b):d[g]=="r"?ib(a,g,b):d[e]=="x"?ib(a,e,b):a[0]}function v(){function a(){return d.apply(null,arguments)}function b(){return(e?d:b.resolve()).apply(null,arguments)}var c=arguments,d,e;b.resolve=function(g){if(e)return d;d=ga(c,g||a);c=null;e=true;return d};b.CallStream=true;b.constructor=r;return b}function jb(){}
function m(){function a(g,h,j){return d(g,h,j)}function b(g,h,j){if(e||g instanceof Ga)return(e?d:b.resolve())(g,h,j);c.push(ga(arguments,a));return b}var c=[],d,e;c.push(ga(arguments,a));b.resolve=function(){if(e)return d;d=k.apply(null,c);e=true;c=null;return d};b.CallStream=true;b.constructor=r;return b}function Ga(a,b){this.input=a;this.index=b||0;this.length=a.length-this.index;this.cache={};return this}function $b(a){return new Ga(a)}function G(a,b,c){return{ast:a,success:b===C?true:b,expecting:c}}
function Ca(a){return G(C,false,a)}function Qa(a){return function(b,c,d){return d(G(null,false,{unexpected:c[a]}))}}function ac(a){return function(b,c,d){return d(G(C,false,a))}}function bc(a,b,c){return c(G(C,false))}function kb(a){return typeof a=="string"?V(a):xa(a)?ga(a):a}function Rc(a){for(;a&&a.func;)a=a.func.apply(null,a.args||[])}function lb(a,b){b=b||0;b++;if(a&&a.func){a=a.func.apply(null,a.args||[]);b%500==0?setTimeout(function(){lb(a,b)},1):lb(a,b)}else b=0}function Sc(a,b,c,d,e){var g=
b instanceof Ga?b:$b(b);(e?lb:Rc)({func:a,args:[g,{},function(h){h.state=g;delete h.index;delete h.length;if(h.success){delete h.error;delete h.expecting}else{h.error=mb(h.expecting,h.state);d&&d(h.error)}c(h)}]})}function mb(a,b,c,d){c=c===undefined?b.index:c;if(typeof a=="string"){var e=b.input.split("\n"),g=e.length,h=b.input.substr(c).split("\n").length;g=g-h+1;e=c-e.splice(0,g-1).join("\n").length;b=d||b.input.substr(c,a.length).substr(0,6);return'Unexpected "'+(b.length?b:"end of file")+(d?
"":'", expecting "'+a)+'" at line '+g+" char "+e}if(xa(a)){a=F(function(j){return typeof j=="object"?j.expecting:j},a);return mb(a.join('" or "'),b)}else if(typeof a=="object")return mb(a.expecting,b,a.at,a.unexpected)}function r(){}function nb(a,b){return function(c,d,e){return{func:a,args:[c,d,function(g){return g.success?{func:b(g.ast),args:[c,d,e]}:e(g)}]}}}function q(a,b){if(a=="scope")throw"Can't use 'scope' as an identifier!";return function(c,d,e){return{func:b,args:[c,d,function(g){if(g.success)d[a]=
g.ast;g=D({},g);delete g.ast;return e(g)}]}}}function t(a,b){b&&H(arguments);return function(c,d,e){return{func:function(){var g;if(typeof a=="string"){if(!(a in d))throw'Not in scope: "'+a+'"';g=d[a]}else g=a(d);return e(G(g))}}}}function ob(a){var b=H(arguments,1);return function(c){return a.apply(null,F(function(d){return c[d]},b))}}function cc(a,b,c){return c(G(a.index))}function dc(a){return function(b,c,d){b.scrollTo(c[a]);return d(Tc)}}function ec(a){return function(b,c,d){return d(G(a))}}
function fc(a,b){return k(q("a",a),q("b",b),t(function(c){return c.a(c.b)}))}function pb(a,b){return k(q("x1",b),N(a,"x1"))}function qb(a,b,c){return k(q("x1",b),q("x2",c),N(a,"x1","x2"))}function gc(a,b,c,d){return k(q("x1",b),q("x2",c),q("x3",d),N(a,"x1","x2","x3"))}function hc(a,b){return k(q("a",a),b,t("a"))}function w(a,b){function c(d,e,g){return{func:a,args:[d,e,function(h){function j(o){var p=o.expecting;if(p)if(xa(p))i=i.concat(p);else i.push(p);if(o.success)delete o.expecting;else o.expecting=
i}var i=[];j(h);return h.ast!==undefined?{func:g,args:[h]}:{func:b,args:[d,e,function(o){j(o);return g(o)}]}}]}}c.constructor=r;return c}function Uc(){var a=F(kb,arguments);return function(b,c,d){for(var e=1,g=a.length,h=a[0];e<g;++e)h=w(h,a[e]);return h(b,c,d)}}function ic(a){return function(b,c,d){function e(i){return function(o,p,z){return{func:i,args:[o,p,function(u){g++;if(!u.success)return z(u);u.ast!==C&&h.push(u.ast);return g<j?e(a[g])(o,p,z):z(u)}]}}}var g=0,h=[],j=a.length;return{func:e(a[g]),
args:[b,c,function(i){i=D({},i);i.ast=h;i.success&&delete i.expecting;return d(i)}]}}}function jc(a){return function(b){return function(c,d,e){function g(i){return function(o,p,z){return{func:i,args:[o,p,function(u){if(!u.success)return z(u);h=true;u.ast!==C&&j.push(u.ast);return g(i)(o,p,z)}]}}}var h=false,j=[];return{func:g(b),args:[c,d,function(i){i=D({},i);i.success=!a||h&&a;i.ast=j;i.success&&delete i.expecting;return e(i)}]}}}}function rb(a){return function(b){var c=kc++,d=function(e,g,h){g=
e.index;var j=e.getCached(c);if(j!==C)return h(j);j=a(b,e,g);e.putCached(c,g,j);return h(j)};d.constructor=r;return d}}function Ra(a){return function(b,c){var d=kc++,e=function(g,h,j){var i=g.index,o=g.getCached(d);if(o!==C)return j(o);return{func:b,args:[g,h,function(p){p=a(c,p,g,i);g.putCached(d,i,p);return j(p)}]}};e.constructor=r;return e}}function lc(a){function b(c,d){return k(q("x",c),q("xs",d),t(ob(I,"x","xs")))}return ya(b,n([]),a)}function Vc(a){return function(b,c,d){return a()(b,c,d)}}
function ha(a){return ya(w,sb,a)}function Sa(a,b){return w(b,n(a))}function Wc(a){return Sa(R.Nothing,pb(R.Just,a))}function Xc(a){return w(k(a,n(null)),n(null))}function Ta(a){return k(a,ia(a))}function tb(a,b){return w(Ua(a,b),n([]))}function Ua(a,b){return k(q("x",a),q("xs",pa(k(b,a))),N(I,"x","xs"))}function mc(a,b){return k(q("x",a),w(k(b,q("xs",function(c,d,e){return nc(a,b)(c,d,e)}),t(function(c){return I(c.scope.x,c.xs)})),t(function(c){return[c.x]})))}function nc(a,b){return w(mc(a,b),n([]))}
function Yc(a,b){return Ha(k(q("x",a),b,t("x")))}function Zc(a,b){return pa(k(q("x",a),b,t("x")))}function $c(a,b){return a<=0?n([]):lc(cb(a,b))}function ad(a,b,c){return w(oc(a,b),n(c))}function bd(a,b,c){return w(pc(a,b),n(c))}function pc(a,b){function c(d){var e=k(q("f",b),q("y",a),function(g,h,j){return c(h.f(d,h.y))(g,h,j)});return w(e,n(d))}return k(q("x",a),function(d,e,g){return c(e.x)(d,e,g)})}function oc(a,b){function c(e){var g=k(q("f",b),q("y",d),function(h,j,i){return i(G(j.f(e,j.y)))});
return w(g,n(e))}var d=k(q("x",a),function(e,g,h){return c(g.x)(e,g,h)});return d}function cd(a,b,c){b=a.at(0);if(b.length){a.scroll(1);return c(G(b))}return c(Ca("anyToken"))}function dd(a,b,c){return c(G(C,!a.length,a.length?"end of input":C))}function ub(a){return O(w(k(q("c",O(a)),Qa("c")),n(null)))}function ed(a,b){function c(e,g,h){return d(e,g,h)}var d=w(k(b,n([])),k(q("x",a),q("xs",c),N(I,"x","xs")));return d}function fd(a){return k(q("state",cc),q("x",a),dc("state"),t("x"))}function Ia(){}
function vb(){}function wb(a){function b(f){return c(V(f))}function c(f){return k(q("x",f),qc,t("x"))}function d(f,l,x){return rc(f,l,x)}function e(f,l,x){return sc(f,l,x)}function g(f,l,x){return xb(f,l,x)}function h(f){return qa(b("("),b(")"),f)}function j(f){return qa(b("{"),b("}"),f)}function i(f){return qa(b("<"),b(">"),f)}function o(f){return qa(b("["),b("]"),f)}function p(f){return tb(f,yb)}function z(f){return tb(f,zb)}function u(f){return Ua(f,yb)}function A(f){return Ua(f,zb)}function S(f){return k(s(f[0]),
n(f[1]))}function L(f){return O(k(V(f[0]),n(f[1])))}function J(f,l){return m("digits","<-",Ha,l)(t,function(x){return Xa(function(K,Ja){return f*K+tc(hb(Ja))},0,x.digits)})}function M(f,l,x){return ra(f,l,x)}function $(f,l){return(l+uc(hb(f)))/10}function aa(f){return f<0?1/aa(-f):Ka(Math.pow(10,f))}function U(f){return v(m("fract","<-",gd)("expo","<-",Sa,1,vc)(t,function(l){return Ka(f+l.fract)*l.expo}),"<|>",m("expo","<-",vc)(t,function(l){return Ka(f)*l.expo}))}function fa(f){return m("f","<-",
U,f)(N,Aa.Right,"f")}function Z(f){return v(c,"$",O,"$",m(V(f))(ub,a.opLetter,"<?>","end of "+f))}function P(f){return Da($a(a.reservedOpNames),f)}function B(f){function l(K){return!K.length?n(null):k(sa(x(K[0]),""+f),l(H(K,1)))}function x(K){return fb(K)?w(s(K.toLowerCase()),s(K.toUpperCase())):s(K)}return a.caseSensitive?V(f):k(l(f),n(f))}function ca(f){return v(c,"$",O,"$",m(B(f))(ub,a.identLetter,"<?>","end of "+f))}function Da(f,l){function x(K){if(!K.length)return false;var Ja=Ob(K[0],l);return Ja.LT?
x(H(K,1)):Ja.EQ?true:Ja.GT?false:null}return x(f)}function Ab(f){f=a.caseSensitive?f:f.toLowerCase();return Da(hd,f)}if(!a.LanguageDef)throw"Type error: unexpected '"+a.constructor.name+"', expecting 'GenLanguageDef.LanguageDef'";var Ea=Ta(E(eb)),Va=m(O(V(a.commentLine)))(ia,E(function(f){return f!="\n"}))(n,null),y=Na(H(a.commentEnd+a.commentStart)),rc=[k(O(V(a.commentEnd)),n(null)),"<|>",k(Ta(Bb(y)),d),"<|>",k(W(y),d),"<?>","end of comment"],sc=v(k(O(V(a.commentEnd)),n(null)),"<|>",k(g,e),"<|>",
k(Ta(Bb(y)),e),"<|>",k(W(y),e),"<?>","end of comment");y=a.nestedComments?sc:rc;var xb=k(O(V(a.commentStart)),y);y=db(a.commentLine);var X=db(a.commentStart),qc=(y&&X?[ia,[Ea,"<?>",""]]:y?[ia,[Ea,"<|>",xb,"<?>",""]]:X?[ia,[Ea,"<|>",Va,"<?>",""]]:[ia,[Ea,"<|>",Va,"<|>",xb,"<?>",""]]).resolve(),zb=b(";"),yb=b(",");Ea=b(".");Va=b(":");y=Za("abfnrtv\\\"'","a\u0008\u000c\n\r\t\u000b\\\"'");X=Za(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB",
"ESC","DEL"]+["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"],["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"]+["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]);y=ha(F(S,y));var da=ha(F(L,X));X=E(function(f){return f!='"'&&f!="\\"&&f>"\u0016"});var ta=s("&"),La=m(Ha,Cb)(s("\\"),"<?>","end of string gap"),ua=m("code","<-",M,"<|>",k(s("o"),J(8,Db)),"<|>",k(s("x"),J(16,Eb)))(t(function(f){return toEnum(Ka(f.code))})),
ja=m(s("^"))("code","<-",wc)(t(function(f){return toEnum(fromEnum(f.code)-fromEnum("A"))}));da=v(y,"<|>",ua,"<|>",da,"<|>",ja,"<?>","escape code");y=k(s("\\"),da);ua=E(function(f){return f!="'"&&f!="\\"&&f>"\u0016"});y=v(ua,"<|>",y,"<?>","literal character");y=v(c,[qa,s("'"),[s("'"),"<?>","end of character"],y],"<?>","character");ta=m(s("\\"))(m(La)(n,R.Nothing),"<|>",m(ta)(n,R.Nothing),"<|>",m("esc","<-",da)(N,R.Just,"esc"));X=v(m("c","<-",X)(N,R.Just,"c"),"<|>",ta,"<?>","string character");X=v(c,
[m("str","<-",qa,s('"'),[s('"'),"<?>","end of string"],[pa,X])(t,function(f){return ya(wa(Nb)(ka,wa(I)),"",f.str)}),"<?>","literal string"]);var ra=J(10,Fb);ta=m(W,"xX")(J,16,Eb);La=m(W,"oO")(J,8,Db);var gd=v(m(s("."))("digits","<-",Ha,Fb,"<?>","fraction")(t,function(f){return ya($,0,f.digits)}),"<?>","fraction");da=v([s("-"),">>",n,Rb],"<|>",[s("+"),">>",n,ka],"<|>",n,ka);var vc=v(m(W,"eE")("f","<-",da)("e","<-",ra,"<?>","exponent")(N,aa,"f","e"),"<?>","exponent");ua=m("n","<-",ra)(function(f,l,
x){return U(l.n)(f,l,x)});ja=m("n","<-",ra)(function(f,l,x){return Sa(Aa.Left(l.n),fa(l.n))(f,l,x)});var la=v(m("n","<-",ta,"<|>",La)(N,Aa.Left,"n"),"<|>",ja,"<|>",fa(0),"<|>",n,Aa.Left(0));ja=v(k(s("0"),la),"<|>",ja);la=v(m(s,"0")(ta,"<|>",La,"<|>",ra,"<|>",n,0),"<?>","");la=w(la,ra);var Ma=m("f","<-",c,da)("n","<-",la)(t,function(f){return f.f(f.n)});da=[c,ja,"<?>","number"].resolve();ua=[c,ua,"<?>","float"].resolve();ja=[c,Ma,"<?>","integer"].resolve();la=[c,la,"<?>","natural"].resolve();Ma=v(m("c",
"<-",a.opStart)("cs","<-",pa,a.opLetter)(N,bb,"c","cs"),"<?>","operator");Ma=v(c,"$",O,"$",m("name","<-",Ma)(function(f,l,x){return(P(l.name)?Qa("reserved operator "+l.name):n(l.name))(f,l,x)}));var Gb=v(m("c","<-",a.identStart)("cs","<-",pa,a.identLetter)(N,bb,"c","cs"),"<?>","identifier");Gb=v(c,"$",O,"$",m("name","<-",Gb)(function(f,l,x){return(Ab(l.name)?Qa("reserved word "+l.name):n(l.name))(f,l,x)}));var xc=$a(a.reservedNames),hd=a.caseSensitive?xc:F(function(f){return f.toLowerCase()},xc);
return vb.TokenParser(za,{identifier:Gb,reserved:ca,operator:Ma,reservedOp:Z,charLiteral:y,stringLiteral:X,natural:la,integer:ja,float_:ua,naturalOrFloat:da,decimal:ra,hexadecimal:ta,octal:La,symbol:b,lexeme:c,whiteSpace:qc,parens:h,braces:j,angles:i,brackets:o,squares:o,semi:zb,comma:yb,colon:Va,dot:Ea,semiSep:z,semiSep1:A,commaSep:p,commaSep1:u})}function Hb(){}function yc(){}function id(a,b){function c(h,j){return function(i,o,p){return h(o[j])(i,o,p)}}function d(h,j){var i=h[0],o=j[0],p=j[1],
z=j[2],u=j[3];j=j[4];if(h.Infix){var A=h[1];if(A.AssocNone)return[o,p,I(i,z),u,j];if(A.AssocLeft)return[o,I(i,p),z,u,j];if(A.AssocRight)return[I(i,o),p,z,u,j]}if(h.Prefix)return[o,p,z,I(i,u),j];if(h.Postfix)return[o,p,z,u,I(i,j)]}function e(h,j){return O(k(j,zc("ambiguous use of a "+h+" associative operator")))}function g(h,j){function i(B){return v(m("f","<-",M)("y","<-",m("z","<-",P)(c,o,"z"))(t,function(ca){return ca.f(B,ca.y)}),"<|>",fa,"<|>",Z)}function o(B){return w(i(B),n(B))}function p(B){return v(m("f",
"<-",$)("y","<-",P)(function(ca,Da,Ab){return z(Da.f(B,Da.y))(ca,Da,Ab)}),"<|>",U,"<|>",Z)}function z(B){return w(p(B),n(B))}function u(B){return m("f","<-",aa)("y","<-",P)(U,"<|>",fa,"<|>",Z,"<|>",t,function(ca){return ca.f(B,ca.y)})}var A=ya(d,[[],[],[],[],[]],j),S=A[1],L=A[2],J=A[3];j=A[4];var M=ha(A[0]),$=ha(S),aa=ha(L);A=sa(ha(J),"");j=sa(ha(j),"");var U=e("right",M),fa=e("left",$),Z=e("non",aa);j=w(j,n(ka));A=w(A,n(ka));var P=m("pre","<-",A)("x","<-",h)("post","<-",j)(t,function(B){return B.post(B.pre(B.x))}).resolve();
return m("x","<-",P)(c,i,"x","<|>",c,p,"x","<|>",c,u,"x","<|>",t,"x","<?>","operator").resolve()}return Xa(g,b,a)}var C,Dc={}.toString,Ec=[].slice,ka=function(a){return a},T=wa(function(a,b){return a(b)}),tc=parseInt,Ka=ka,uc=ka,ma=window.JSParsec={};D(ma,{curry:wa,const_:Kb,isArray:xa,isDefined:Wa,slice:H,foldl:Xa,foldr:ya,map:F,filter:Lb,indexOf:Ya,lastIndexOf:Mb,zip:Za,sort:$a,nub:Na,maybe:Nb,compare:Ob,compose:Pb,compose1:Qb,call:T,id:ka,flip:ab,cons:I,consJoin:bb,replicate:cb,negate:Rb,null_:db,
elem:Oa,isSpace:eb,isUpper:Sb,isLower:Tb,isAlpha:fb,isAlphaNum:Ub,isDigit:Vb,isHexDigit:gb,isOctDigit:Wb,digitToInt:hb,range:Fc,extend:D,namespace:Kc,toInteger:tc,fromInteger:Ka,fromIntegral:uc,fst:Gc,snd:Hc,uncurry:Ic,lookup:Jc});var za=new Xb;Pa.prototype.toString=Yb();Pa.prototype.dataConstructorToString=Yb(true);ea(R,[["Just","a"],"Nothing"]);ea(Fa,["LT","EQ","GT"]);ea(Aa,[["Left","a"],["Right","b"]]);var Ba={$:{func:T,fixity:oa(0)},".":{func:Qb,fixity:oa(9)},":":{func:I,fixity:oa(5)}};Array.prototype.resolve=
function(){return ga(this)};var Q=new jb;D(ma,{data:ea,ADT:Pa,record:za,Maybe:R,Ordering:Fa,Either:Aa,operators:Ba,infix:Zb,infixl:ba,infixr:oa,arr:Oc,op:Qc,str:Pc,ex:v,resolve:ga,recurse:Q,Recurse:jb,cs:m});Ga.prototype={memoize:false,scrollTo:function(a){this.index=a;this.length=this.input.length-a;return this},scroll:function(a){this.index+=a;this.length-=a;return this},at:function(a){return this.input.charAt(this.index+a)},substring:function(a,b){return this.input.substring(a+this.index,(b||this.length)+
this.index)},substr:function(a,b){return this.input.substring(a+this.index,b||this.length)},toString:function(){var a=this.substring(0);return"PS at "+this.index+" "+(a.length?'"'+a+'"':"Empty")},getCached:function(a){if(this.memoize)if(a=this.cache[a])if(a=a[this.index]){this.index=a.index;this.length=a.length;return a}},putCached:function(a,b,c){if(!this.memoize)return false;c.index=this.index;c.length=this.length;var d=this.cache[a];d||(d=this.cache[a]={});d[b]=c}};var Tc=G(C),zc=ac,sb=bc;Q=sb;
var kc=0,Ib=function(a,b){function c(d,e,g){return{func:a,args:[d,e,function(h){return h.success?b(d,e,g):g(h)}]}}c.constructor=r;return c},k=function(){function a(c,d,e){var g={},h=1,j=b.length,i=b[0];for(g.scope=d;h<j;++h)i=Ib(i,b[h]);return i(c,g,e)}var b=F(kb,arguments);a.constructor=r;return a},N=Pb(t,ob),n=ec,Ac=n,na=pb,va=Ib,Y=w,pa=jc(false),Ha=jc(true),O=Ra(function(a,b,c,d){if(b.success)return b;c.scrollTo(d);return Ca(b.expecting)}),ia=function(a){return Ra(function(b,c){c=D({},c);c.ast=
C;return c})(pa(a),null)},s=rb(function(a,b){if(b.length>0&&b.at(0)==a){b.scroll(1);return G(a)}return Ca(a)}),E=rb(function(a,b){var c=b.at(0);if(b.length>0&&a(c)){b.scroll(1);return G(c)}return Ca(c)}),V=function(a){return Ra(function(b,c,d,e){c.ast=c.ast.join("");c=D({},c);if(c.success)delete c.expecting;else c.expecting={at:e,expecting:a};if(!c.ast.length)c.ast=C;return c})(ic(F(s,a)),null)},sa=Ra(function(a,b,c,d){if(!b.success){b=D({},b);b.expecting={at:d,expecting:a}}return b}),Jb=rb(function(a,
b){var c;if(typeof a=="string")if(b.substring(0,a.length)==a){b.scroll(a.length);c=G(a)}else c=Ca(a);else if(a.exec){var d=new RegExp("^"+a.source);c=b.substring(0);d=(d=(d=d.exec(c))&&d[0])&&d.length;c=c.substr(0,d);if(d){b.scroll(d);c=G(c)}else c=Ca(a.source)}return c});D(Ba,{"<-":{func:q,fixity:oa(-1)},">>=":{func:nb,fixity:ba(1)},"=<<":{func:ab(nb),fixity:oa(1)},">>":{func:va,fixity:ba(1)},"*>":{func:va,fixity:ba(4)},"<*":{func:hc,fixity:ba(4)},"<$>":{func:na,fixity:ba(4)},"<*>":{func:fc,fixity:ba(4)},
"<**>":{func:wa(qb)(ab(T)),fixity:ba(4)},"<$":{func:function(a,b){return hc(Ac(value),b)},fixity:ba(4)},"<|>":{func:w,fixity:oa(1)},"<?>":{func:sa,fixity:Zb(0)}});D(ma,{sequence:lc,run:Sc,Parser:r,ParseState:Ga,ps:$b,toParser:kb,unexpected:Qa,parsecMap:na,fmap:na,liftM:pb,liftM2:qb,liftM3:gc,liftA:na,liftA2:qb,liftA3:gc,ap:fc,parserBind:nb,parserReturn:ec,return_:n,pure:Ac,parserFail:ac,fail:zc,parserZero:bc,mzero:sb,empty:Q,parserPlus:w,parserPlusN:Uc,mplus:Y,do_:k,do2:Ib,bind:q,ret:t,withBound:ob,
returnCall:N,lazy:Vc,getParserState:cc,setParserState:dc,tokens:ic,many:pa,many1:Ha,string:V,char_:s,satisfy:E,label:sa,try_:O,skipMany:ia,match:Jb});var W=function(a){return sa(E(function(b){return Oa(b,a)}),"oneOf("+a+")")},Bb=function(a){return sa(E(function(b){return!Oa(b,a)}),"noneOf("+a+")")},Cb=[E,eb,"<?>","space"].resolve();na=[ia,Cb,"<?>","white space"].resolve();va=[s,"\n","<?>","new-line"].resolve();Y=[s,"\t","<?>","tab"].resolve();var wc=[E,Sb,"<?>","uppercase letter"].resolve();Jb=[E,
Tb,"<?>","lowercase letter"].resolve();T=[E,Ub,"<?>","letter or digit"].resolve();Q=[E,fb,"<?>","letter"].resolve();var Fb=[E,Vb,"<?>","digit"].resolve(),Eb=[E,gb,"<?>","hexadecimal digit"].resolve(),Db=[E,Wb,"<?>","octal digit"].resolve(),jd=[E,Kb(true)].resolve();D(ma,{oneOf:W,noneOf:Bb,space:Cb,spaces:na,newline:va,tab:Y,upper:wc,lower:Jb,alphaNum:T,letter:Q,digit:Fb,hexDigit:Eb,octDigit:Db,anyChar:jd});var qa=wa(function(a,b,c){return k(a,q("x",c),b,t("x"))});D(ma,{choice:ha,count:$c,between:qa,
option:Sa,optionMaybe:Wc,optional:Xc,skipMany1:Ta,sepBy:tb,sepBy1:Ua,endBy:Zc,endBy1:Yc,sepEndBy:nc,sepEndBy1:mc,chainl:bd,chainl1:pc,chainr:ad,chainr1:oc,eof:dd,notFollowedBy:ub,manyTill:ed,lookAhead:fd,anyToken:cd});ea(Ia,[["LanguageDef",{commentStart:String,commentEnd:String,commentLine:String,nestedComments:Boolean,identStart:r,identLetter:r,opStart:r,opLetter:r,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);ea(vb,[["TokenParser",{identifier:r,reserved:Function,operator:r,
reservedOp:Function,charLiteral:r,stringLiteral:r,natural:r,integer:r,float_:r,naturalOrFloat:r,decimal:r,hexadecimal:r,octal:r,symbol:Function,lexeme:Function,whiteSpace:r,parens:Function,braces:Function,angles:Function,brackets:Function,squares:Function,semi:r,comma:r,colon:r,dot:r,semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);D(ma,{GenLanguageDef:Ia,GenTokenParser:vb,makeTokenParser:wb});Y=W(":!#$%&*+./<=>?@\\^|-~");na=Ia.LanguageDef(za,{commentStart:"",commentEnd:"",
commentLine:"",nestedComments:true,identStart:[Q,"<|>",s("_")].resolve(),identLetter:[T,"<|>",W("_'")].resolve(),opStart:Y,opLetter:Y,reservedOpNames:[],reservedNames:[],caseSensitive:true});va=Ia.LanguageDef(za,{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,identStart:Q,identLetter:[T,"<|>",W,"_'"].resolve(),opStart:Y,opLetter:Y,reservedOpNames:[],reservedNames:[],caseSensitive:true});T=Ia.LanguageDef(za,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:true,
identStart:Q,identLetter:[T,"<|>",W,"_'"].resolve(),opStart:Y,opLetter:Y,reservedOpNames:[],reservedNames:[],caseSensitive:false});Q=va.update({reservedOpNames:["::","..","=","\\","|","<-","->","@","~","=>"],reservedNames:["let","in","case","of","if","then","else","data","type","class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Bc=Q.update({identLetter:[Q.identLetter,"<|>",s("#")].resolve(),reservedNames:Q.reservedNames.concat(["foreign",
"import","export","primitive","_ccall_","_casm_","forall"])}),Cc=T.update({reservedNames:["case","class","default","extends","import","in","let","new","of","package"],caseSensitive:true});D(ma,{emptyDef:na,haskellStyle:va,javaStyle:T,haskellDef:Bc,mondrianDef:Cc,getHaskell:function(){return wb(Bc)},getMondrian:function(){return wb(Cc)}});ea(Hb,["AssocNone","AssocLeft","AssocRight"]);ea(yc,[["Infix",r,Hb],["Prefix",r],["Postfix",r]]);D(ma,{Assoc:Hb,Operator:yc,buildExpressionParser:id})})();

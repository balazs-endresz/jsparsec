/*

 JSParsec - A parser combinator library for JavaScript

 Version: 1.0.1

 http://code.google.com/p/jsparsec/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators and the memoization is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec:
 http://www.haskell.org/haskellwiki/Parsec

*/
(function(){function oa(a){function b(){var c=F(arguments);return c.length>=(a._length===undefined?a.length:a._length)?a.apply(null,c):function(){return b.apply(null,c.concat(F(arguments)))}}return b}function Mb(a){return function(){return a}}function va(a){return Dc.call(a)=="[object Array]"}function Za(a){return a!==y}function F(a,b){return Ec.call(a,b||0)}function $a(a,b,c){for(var d=0,f=c.length;d<f;++d)b=a(b,c[d]);return b}function wa(a,b,c){for(var d=c.length-1;d>-1;--d)b=a(c[d],b);return b}
function D(a,b){for(var c=[],d=0,f=b.length;d<f;++d)c[d]=a(b[d],d);return c}function Nb(a,b){for(var c=[],d=0,f=a.length;d<f;++d)b(a[d])&&c.push(a[d]);return c}function ab(a,b){var c=a.length;if(!c)return-1;for(var d=0;d<c;d++)if(a[d]===b)return d;return-1}function Ob(a,b){var c=a.length;if(!c)return-1;for(c=c-1;c>-1;--c)if(a[c]===b)return c;return-1}function bb(a,b){for(var c=[],d=0,f=Math.min(a.length,b.length);d<f;++d)c[d]=[a[d],b[d]];return c}function cb(a){var b=typeof a;if(b=="object")return a.sort();
if(b=="string")return F(a).sort().join("")}function Pa(a,b){b=b===y?[]:b;var c=a[0],d=F(a,1);return!a.length?[]:Qa(c,b)?Pa(d,b):G(c,Pa(d,G(c,b)))}function Pb(a,b,c){if(c.Nothing)return a;if(c.Just)return b(c[0])}function Qb(a,b){return a===b?Fa.EQ:a<=b?Fa.LT:Fa.GT}function z(a,b){for(var c in b)a[c]=b[c];return a}function Rb(a,b){return function(){return a(b.apply(null,arguments))}}function Sb(a,b){return function(c){var d=F(arguments,1);d.unshift(b(c));return a.apply(null,d)}}function db(a){return function(b,
c){return a(c,b)}}function G(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return[a].concat(b)}function eb(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return a+b.join("")}function fb(a,b){for(var c=[],d=0;d<a;++d)c[d]=b;return c}function Tb(a){return-a}function gb(a){return!a.length}function Qa(a,b){return(b.indexOf?b.indexOf(a):ab(b,a))!=-1}function hb(a){return/^\s$/.test(a)}function Ub(a){return a.toUpperCase()==a}function Vb(a){return a.toLowerCase()==a}function Wb(a){return/^\w$/.test(a)}
function ib(a){return/^\w$/.test(a)&&/^\D$/.test(a)}function Xb(a){return/^\d$/.test(a)}function jb(a){return/^[0-9A-Fa-f]$/.test(a)}function Yb(a){return/^[0-7]$/.test(a)}function kb(a){if(!jb(a))throw"Data.Char.digitToInt: not a digit "+a;return parseInt(a,16)}function Fc(a,b){return{indexOf:function(c){return c>=a&&c<=b?true:-1},toString:function(){return"range("+a+", "+b+")"}}}function Gc(a){return a[0]}function Hc(a){return a[1]}function Ic(a){return function(b){return a(b[0],b[1])}}function Jc(a,
b){var c=b.length;if(!c)return Q.Nothing;for(var d=0;d<c;++d)if(b[d][0]===a)return Q.Just(b[d][1]);return Q.Nothing}function Kc(){var a,b;D(function(c){b=c.split(".");a=window[b[0]]=window[b[0]]||{};D(function(d){a=a[d]=a[d]||{}},b.slice(1))},arguments);return a}function Zb(){}function Lc(a,b){if(!/^[0-9]$/.test(b))return b;if(typeof a!="object")return b;var c=0;for(var d in a){if(a.hasOwnProperty(d)&&c==b)return d;c++}return-1}function Ra(){}function $b(a){return function(){var b=[],c=this._recordset;
if(c&&!va(c)){for(var d in c){var f=a?c[d].name||c[d]:this[d];if(!a&&f instanceof Function)f=f.constructor!=Function?f.constructor.name:"Function("+f.name+")";b.push(d+" :: "+f)}c=fb(this._dataConstructor.length+2," ").join("");b="{"+b.join("\n"+c+",")+"\n"+c+"}"}else{for(d=0;d in this;d++)b.push(a?c[d].name||c[d]:this[d]);b=b.join(" ")}return"("+this._dataConstructor+(b?" ":"")+b+")"}}function da(a,b){function c(j,i){function o(A,B){var H=A instanceof Zb,R=H?B:F(arguments),K=new a,I=0;K.constructor=
a;K._recordset=p&&i[0]||i;K._dataConstructor=j;K.update=function(ea){var Z={};for(var O in i[0]){Z[O]=this[O];if(O in ea)Z[O]=ea[O]}return o(xa,Z)};K[j]=true;if(R!==y)for(var L in R)if(R.hasOwnProperty(L)&&L!=j){if(H&&i&&p)if(!(L in i[0]))throw"The accessor '"+L+"' is not defined for the data constructor '"+j+"'";var $=Lc(i[0],L),aa=R[I]!==undefined?R[I]:R[$],U=p?i[0][$]:i[I];if(U.name&&!(U==aa.constructor||aa instanceof U))throw"Type error: expecting '"+U.name+"' instead of '"+aa.constructor.name+
"' in the argument '"+($||I)+"' of the data constructor '"+j+"' of type '"+a.name+"'";K[$]=K[I]=K[L]=R[L];I++}else if(L==j)throw"Accessor has the same name as the data constructor: '"+j+"'";return K}var p=i&&typeof i[0]=="object";return o}if(a.constructors)throw"Type constructor has been already defined: '"+a.name+"'";a.constructors=b;a.prototype=new Ra;for(var d=0,f=b.length;d<f;++d){var e=typeof b[d]!="object",h=e?b[d]:b[d][0];if(h in{})throw"The name of the data constructor can't be a property of Object.prototype as well!";
a[h]=e?c(h)():c(h,F(b[d],1));if(!e)a[h]._length=F(b[d],1).length}}function Q(){}function Fa(){}function ya(){}function ba(a){return["l",a]}function pa(a){return["r",a]}function ac(a){return["x",a]}function Mc(a){if(a)if(!a._String){var b=za[a];if(a._Op&&!b)return"l";return b&&(b.fixity[0]||"l")}}function Nc(a){if(a)if(!a._String){var b=za[a];if(a._Op&&!b)return 9;return b&&(Za(b.fixity[1])?b.fixity[1]:9)}}function lb(a,b,c){var d;if(a[b]._Op){delete a[b]._Op;d=a[b]}else d=za[a[b]].func;d=d(a[b-1],
a[b+1]);a.splice(b-1,3,d);return fa(a,c)}function Oc(a){a._Array=true;return a}function Pc(a){a=new String(a);a._String=true;return a}function Qc(a){a._Op=true;return a}function fa(a,b){a=D(function(i){if(i&&i._Array){delete i._Array;return i}return va(i)?fa(i,b):i&&i.CallStream?i.resolve():i},a);if(b)a=D(function(i){return i instanceof mb?b:i},a);for(var c=[],d=[],f=0,e=a.length;f<e;++f){var h=a[f],j=false;if(za[h])j=true;if(h&&h._String){j=false;h=h.toString()}if(h&&h._Op)j=true;if(!j&&f!=e-1)c.push(h);
else{f==e-1&&c.push(h);c=c.length>1?c[0].apply(null,c.slice(1)):c[0];d.push(c);f!=e-1&&d.push(h);c=[]}}a=d;d=D(Mc,a);e=D(Nc,a);h=Nb(e,Za).sort().pop();f=ab(e,h);e=Ob(e,h);return d[f]=="l"?lb(a,f,b):d[e]=="r"?lb(a,e,b):d[f]=="x"?lb(a,f,b):a[0]}function Rc(){function a(){return d.apply(null,arguments)}function b(){return(f?d:b.resolve()).apply(null,arguments)}var c=arguments,d,f;b.resolve=function(){if(f)return d;d=fa(c,a);c=null;f=true;return d};b.CallStream=true;return b}function mb(){}function m(){function a(e,
h,j){return d(e,h,j)}function b(e,h,j){if(f||e instanceof Ga)return(f?d:b.resolve())(e,h,j);c.push(fa(arguments,a));return b}var c=[],d,f;c.push(fa(arguments,a));b.resolve=function(){if(f)return d;d=k.apply(null,c);f=true;c=null;return d};b.CallStream=true;return b}function Ga(a,b){this.input=a;this.index=b||0;this.length=a.length-this.index;this.cache={};return this}function bc(a){return new Ga(a)}function E(a,b,c){return{ast:a,success:b===y?true:b,expecting:c}}function Aa(a){return E(y,false,a)}
function Sa(a){return function(b,c,d){return d(E(null,false,{unexpected:c[a]}))}}function cc(a){return function(b,c,d){return d(E(y,false,a))}}function dc(a,b,c){return c(E(y,false))}function nb(a){return typeof a=="string"?V(a):va(a)?fa(a):a}function Sc(a){for(;a&&a.func;)a=a.func.apply(null,a.args||[])}function ob(a,b){b=b||0;b++;if(a&&a.func){a=a.func.apply(null,a.args||[]);b%500==0?setTimeout(function(){ob(a,b)},1):ob(a,b)}else b=0}function Tc(a,b,c,d,f){var e=b instanceof Ga?b:bc(b);(f?ob:Sc)({func:a,
args:[e,{},function(h){h.state=e;delete h.index;delete h.length;if(h.success){delete h.error;delete h.expecting}else{h.error=pb(h.expecting,h.state);d&&d(h.error)}c(h)}]})}function pb(a,b,c,d){c=c===undefined?b.index:c;if(typeof a=="string"){var f=b.input.split("\n"),e=f.length,h=b.input.substr(c).split("\n").length;e=e-h+1;f=c-f.splice(0,e-1).join("\n").length;b=d||b.input.substr(c,a.length).substr(0,6);return'Unexpected "'+(b.length?b:"end of file")+(d?"":'", expecting "'+a)+'" at line '+e+" char "+
f}if(va(a)){a=D(function(j){return typeof j=="object"?j.expecting:j},a);return pb(a.join('" or "'),b)}else if(typeof a=="object")return pb(a.expecting,b,a.at,a.unexpected)}function q(){}function qb(a,b){return function(c,d,f){return{func:a,args:[c,d,function(e){return e.success?f(b(e.ast)):f(e)}]}}}function s(a,b){if(a=="scope")throw"Can't use 'scope' as an identifier!";return function(c,d,f){return{func:b,args:[c,d,function(e){if(e.success)d[a]=e.ast;return f(e)}]}}}function t(a,b){b&&F(arguments);
return function(c,d,f){return{func:function(){var e;if(typeof a=="string"){if(!(a in d))throw'Not in scope: "'+a+'"';e=d[a]}else e=a(d);return f(E(e))}}}}function rb(a){var b=F(arguments,1);return function(c){return a.apply(null,D(function(d){return c[d]},b))}}function ec(a,b,c){return c(E(a.index))}function fc(a){return function(b,c,d){b.scrollTo(c[a]);return d(Uc)}}function gc(a){return function(b,c,d){return d(E(a))}}function Ha(a,b){return Ba(function(c){return c[0](c[1])},sb([a,b]))}function hc(a,
b){a=oa(a);return function(c,d,f){return{func:b,args:[c,d,function(e){if(!e.success)return f(e);e=z({},e);e.ast=a(e.ast);return f(e)}]}}}function ic(a,b){return k(s("a",a),b,t("a"))}function v(a,b){function c(d,f,e){return{func:a,args:[d,f,function(h){function j(o){var p=o.expecting;if(p)if(va(p))i=i.concat(p);else i.push(p);if(o.success)delete o.expecting;else o.expecting=i}var i=[];j(h);return h.ast!==undefined?{func:e,args:[h]}:{func:b,args:[d,f,function(o){j(o);return e(o)}]}}]}}c.constructor=
q;return c}function Vc(){var a=D(nb,arguments);return function(b,c,d){for(var f=1,e=a.length,h=a[0];f<e;++f)h=v(h,a[f]);return h(b,c,d)}}function sb(a){return function(b,c,d){function f(i){return function(o,p,A){return{func:i,args:[o,p,function(B){e++;if(!B.success)return A(B);B.ast!==y&&h.push(B.ast);return e<j?f(a[e])(o,p,A):A(B)}]}}}var e=0,h=[],j=a.length;return{func:f(a[e]),args:[b,c,function(i){i=z({},i);i.ast=h;i.success&&delete i.expecting;return d(i)}]}}}function jc(a){return function(b){return function(c,
d,f){function e(i){return function(o,p,A){return{func:i,args:[o,p,function(B){if(!B.success)return A(B);h=true;B.ast!==y&&j.push(B.ast);return e(i)(o,p,A)}]}}}var h=false,j=[];return{func:e(b),args:[c,d,function(i){i=z({},i);i.success=!a||h&&a;i.ast=j;i.success&&delete i.expecting;return f(i)}]}}}}function tb(a){return function(b){var c=kc++,d=function(f,e,h){e=f.index;var j=f.getCached(c);if(j!==y)return h(j);j=a(b,f,e);f.putCached(c,e,j);return h(j)};d.constructor=q;return d}}function Ta(a){return function(b,
c){var d=kc++,f=function(e,h,j){var i=e.index,o=e.getCached(d);if(o!==y)return j(o);return{func:b,args:[e,h,function(p){p=a(c,p,e,i);e.putCached(d,i,p);return j(p)}]}};f.constructor=q;return f}}function lc(a){function b(c,d){return k(s("x",c),s("xs",d),t(rb(G,"x","xs")))}return wa(b,n([]),a)}function ga(a){return wa(v,ub,a)}function Ua(a,b){return v(b,n(a))}function Wc(a){return Ua(Q.Nothing,mc(Q.Just,a))}function Xc(a){return v(k(a,n(null)),n(null))}function Va(a){return k(a,ha(a))}function vb(a,
b){return v(Wa(a,b),n([]))}function Wa(a,b){return k(s("x",a),s("xs",qa(k(b,a))),W(G,"x","xs"))}function nc(a,b){return k(s("x",a),v(k(b,s("xs",function(c,d,f){return oc(a,b)(c,d,f)}),t(function(c){return G(c.scope.x,c.xs)})),t(function(c){return[c.x]})))}function oc(a,b){return v(nc(a,b),n([]))}function Yc(a,b){return Ia(k(s("x",a),b,t("x")))}function Zc(a,b){return qa(k(s("x",a),b,t("x")))}function $c(a,b){return a<=0?n([]):lc(fb(a,b))}function ad(a,b,c){return v(pc(a,b),n(c))}function bd(a,b,c){return v(qc(a,
b),n(c))}function qc(a,b){function c(d){var f=k(s("f",b),s("y",a),function(e,h,j){return c(h.f(d,h.y))(e,h,j)});return v(f,n(d))}return k(s("x",a),function(d,f,e){return c(f.x)(d,f,e)})}function pc(a,b){function c(f){var e=k(s("f",b),s("y",d),function(h,j,i){return i(E(j.f(f,j.y)))});return v(e,n(f))}var d=k(s("x",a),function(f,e,h){return c(e.x)(f,e,h)});return d}function cd(a,b,c){b=a.at(0);if(b.length){a.scroll(1);return c(E(b))}return c(Aa("anyToken"))}function dd(a,b,c){return c(E(y,!a.length,
a.length?"end of input":y))}function wb(a){return M(v(k(s("c",M(a)),Sa("c")),n(null)))}function ed(a,b){function c(f,e,h){return d(f,e,h)}var d=v(k(b,n([])),k(s("x",a),s("xs",c),W(G,"x","xs")));return d}function fd(a){return k(s("state",ec),s("x",a),fc("state"),t("x"))}function Ja(){}function xb(){}function yb(a){function b(g){return c(V(g))}function c(g){return k(s("x",g),rc,t("x"))}function d(g,l,u){return sc(g,l,u)}function f(g,l,u){return tc(g,l,u)}function e(g,l,u){return zb(g,l,u)}function h(g){return ra(b("("),
b(")"),g)}function j(g){return ra(b("{"),b("}"),g)}function i(g){return ra(b("<"),b(">"),g)}function o(g){return ra(b("["),b("]"),g)}function p(g){return vb(g,Ab)}function A(g){return vb(g,Bb)}function B(g){return Wa(g,Ab)}function H(g){return Wa(g,Bb)}function R(g){return k(r(g[0]),n(g[1]))}function K(g){return M(k(V(g[0]),n(g[1])))}function I(g,l){return m("digits","<-",Ia,l)(t,function(u){return $a(function(J,Ka){return g*J+uc(kb(Ka))},0,u.digits)}).resolve()}function L(g,l,u){return sa(g,l,u)}
function $(g,l){return(l+vc(kb(g)))/10}function aa(g){return g<0?1/aa(-g):La(Math.pow(10,g))}function U(g){return[m("fract","<-",gd)("expo","<-",Ua,1,wc)(t,function(l){return La(g+l.fract)*l.expo}),"<|>",m("expo","<-",wc)(t,function(l){return La(g)*l.expo})].resolve()}function ea(g){return m("f","<-",U,g)(W,ya.Right,"f").resolve()}function Z(g){return[c,"$",M,"$",m(V(g))(wb,a.opLetter,"<?>","end of "+g)].resolve()}function O(g){return ia(cb(a.reservedOpNames),g)}function w(g){function l(J){return!J.length?
n(null):k(ta(u(J[0]),""+g),l(F(J,1)))}function u(J){return ib(J)?v(r(J.toLowerCase()),r(J.toUpperCase())):r(J)}return a.caseSensitive?V(g):k(l(g),n(g))}function N(g){return[c,"$",M,"$",m(w(g))(wb,a.identLetter,"<?>","end of "+g)].resolve()}function ia(g,l){function u(J){if(!J.length)return false;var Ka=Qb(J[0],l);return Ka.LT?u(F(J,1)):Ka.EQ?true:Ka.GT?false:null}return u(g)}function Ca(g){g=a.caseSensitive?g:g.toLowerCase();return ia(hd,g)}if(!a.LanguageDef)throw"Type error: unexpected '"+a.constructor.name+
"', expecting 'GenLanguageDef.LanguageDef'";var ja=Va(C(hb)),Xa=m(M(V(a.commentLine)))(ha,C(function(g){return g!="\n"}))(n,null).resolve(),x=Pa(F(a.commentEnd+a.commentStart)),sc=[k(M(V(a.commentEnd)),n(null)),"<|>",k(Va(Cb(x)),d),"<|>",k(X(x),d),"<?>","end of comment"].resolve(),tc=[k(M(V(a.commentEnd)),n(null)),"<|>",k(e,f),"<|>",k(Va(Cb(x)),f),"<|>",k(X(x),f),"<?>","end of comment"].resolve();x=a.nestedComments?tc:sc;var zb=k(M(V(a.commentStart)),x);x=gb(a.commentLine);var Y=gb(a.commentStart),
rc=(x&&Y?[ha,[ja,"<?>",""]]:x?[ha,[ja,"<|>",zb,"<?>",""]]:Y?[ha,[ja,"<|>",Xa,"<?>",""]]:[ha,[ja,"<|>",Xa,"<|>",zb,"<?>",""]]).resolve(),Bb=b(";"),Ab=b(",");ja=b(".");Xa=b(":");x=bb("abfnrtv\\\"'","a\u0008\u000c\n\r\t\u000b\\\"'");Y=bb(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"]+["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"],["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3",
"DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"]+["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]);x=ga(D(R,x));var ca=ga(D(K,Y));Y=C(function(g){return g!='"'&&g!="\\"&&g>"\u0016"});var ua=r("&"),Ma=m(Ia,Db)(r("\\"),"<?>","end of string gap").resolve(),Na=m("code","<-",L,"<|>",k(r("o"),I(8,Eb)),"<|>",k(r("x"),I(16,Fb)))(t(function(g){return toEnum(La(g.code))})).resolve(),ka=m(r("^"))("code","<-",xc)(t(function(g){return toEnum(fromEnum(g.code)-fromEnum("A"))})).resolve();
ca=[x,"<|>",Na,"<|>",ca,"<|>",ka,"<?>","escape code"].resolve();x=k(r("\\"),ca);x=[C(function(g){return g!="'"&&g!="\\"&&g>"\u0016"}),"<|>",x,"<?>","literal character"].resolve();x=[c,[ra,r("'"),[r("'"),"<?>","end of character"],x],"<?>","character"].resolve();ua=m(r("\\"))(m(Ma)(n,Q.Nothing),"<|>",m(ua)(n,Q.Nothing),"<|>",m("esc","<-",ca)(W,Q.Just,"esc")).resolve();Y=[m("c","<-",Y)(W,Q.Just,"c"),"<|>",ua,"<?>","string character"].resolve();Y=c([m("str","<-",ra,r('"'),[r('"'),"<?>","end of string"],
[qa,Y])(t,function(g){return wa(oa(Pb)(la,oa(G)),"",g.str)}),"<?>","literal string"].resolve());var sa=I(10,Gb);ua=m(X,"xX")(I,16,Fb).resolve();Ma=m(X,"oO")(I,8,Eb).resolve();var gd=[m(r("."))("digits","<-",Ia,Gb,"<?>","fraction")(t,function(g){return wa($,0,g.digits)}),"<?>","fraction"].resolve();ca=[[r("-"),">>",n,Tb],"<|>",[r("+"),">>",n,la],"<|>",n,la].resolve();var wc=[m(X,"eE")("f","<-",ca)("e","<-",sa,"<?>","exponent")(W,aa,"f","e"),"<?>","exponent"].resolve();Na=m("n","<-",sa)(function(g,
l,u){return U(l.n)(g,l,u)}).resolve();ka=m("n","<-",sa)(function(g,l,u){return Ua(ya.Left(l.n),ea(l.n))(g,l,u)}).resolve();var Da=[m("n","<-",ua,"<|>",Ma)(W,ya.Left,"n"),"<|>",ka,"<|>",ea(0),"<|>",n,ya.Left(0)].resolve(),Oa=[k(r("0"),Da),"<|>",ka].resolve();Da=[[m(r,"0")(ua,"<|>",Ma,"<|>",sa,"<|>",n,0),"<?>",""].resolve(),"<|>",sa].resolve();ka=m("f","<-",c,ca)("n","<-",Da)(t,function(g){return g.f(g.n)});ca=[c,Oa,"<?>","number"].resolve();Na=[c,Na,"<?>","float"].resolve();ka=[c,ka,"<?>","integer"].resolve();
Da=[c,Da,"<?>","natural"].resolve();Oa=[m("c","<-",a.opStart)("cs","<-",qa,a.opLetter)(W,eb,"c","cs"),"<?>","operator"].resolve();Oa=[c,"$",M,"$",m("name","<-",Oa)(function(g,l,u){return(O(l.name)?Sa("reserved operator "+l.name):n(l.name))(g,l,u)})].resolve();var Hb=[m("c","<-",a.identStart)("cs","<-",qa,a.identLetter)(W,eb,"c","cs"),"<?>","identifier"].resolve();Hb=[c,"$",M,"$",m("name","<-",Hb)(function(g,l,u){return(Ca(l.name)?Sa("reserved word "+l.name):n(l.name))(g,l,u)})].resolve();var yc=cb(a.reservedNames),
hd=a.caseSensitive?yc:D(function(g){return g.toLowerCase()},yc);return xb.TokenParser(xa,{identifier:Hb,reserved:N,operator:Oa,reservedOp:Z,charLiteral:x,stringLiteral:Y,natural:Da,integer:ka,float_:Na,naturalOrFloat:ca,decimal:sa,hexadecimal:ua,octal:Ma,symbol:b,lexeme:c,whiteSpace:rc,parens:h,braces:j,angles:i,brackets:o,squares:o,semi:Bb,comma:Ab,colon:Xa,dot:ja,semiSep:A,semiSep1:H,commaSep:p,commaSep1:B})}function Ib(){}function Jb(){}function id(a,b){function c(f,e){function h(w,N){return function(ia,
Ca,ja){return w(Ca[N])(ia,Ca,ja)}}function j(w,N){return M(k(N,zc("ambiguous use of a "+w+" associative operator")))}function i(w){return[m("f","<-",L)("y","<-",m("z","<-",O)(h,o,"z"))(t,function(N){return N.f(w,N.y)}),"<|>",ea,"<|>",Z].resolve()}function o(w){return v(i(w),n(w))}function p(w){return[m("f","<-",$)("y","<-",O)(function(N,ia,Ca){return A(ia.f,w,ia.y)(N,ia,Ca)}),"<|>",U,"<|>",Z].resolve()}function A(w){return v(p(w),n(w))}function B(w){return m("f","<-",aa)("y","<-",O)(U,"<|>",ea,"<|>",
Z,"<|>",t,function(N){return N.f(w,N.y)}).resolve()}var H=wa(d,[[],[],[],[],[]],e),R=H[1],K=H[2],I=H[3];e=H[4];var L=ga(H[0]),$=ga(R),aa=ga(K);H=ta(ga(I),"");e=ta(ga(e),"");var U=j("right",L),ea=j("left",$),Z=j("non",aa);e=v(e,n(la));H=v(H,n(la));var O=m("pre","<-",H)("x","<-",f)("post","<-",e)(t,function(w){return w.post(w.pre(w.x))}).resolve();return m("x","<-",O)(h,i,"x","<|>",h,p,"x","<|>",h,B,"x","<|>",t,"x","<?>","operator").resolve()}function d(f,e){if(!(f instanceof Jb))throw"Type error: expecting type 'Operator' instead of "+
f.constructor;var h=f[0],j=e[0],i=e[1],o=e[2],p=e[3];e=e[4];if(f.Infix){var A=f[1];if(A.AssocNone)return[j,i,G(h,o),p,e];if(A.AssocLeft)return[j,G(h,i),o,p,e];if(A.AssocRight)return[G(h,j),i,o,p,e]}if(f.Prefix)return[j,i,o,G(h,p),e];if(f.Postfix)return[j,i,o,p,G(h,e)]}return $a(c,b,a)}var y,Dc={}.toString,Ec=[].slice,la=function(a){return a},S=oa(function(a,b){return a(b)}),uc=parseInt,La=la,vc=la,ma=window.JSParsec={};z(ma,{curry:oa,const_:Mb,isArray:va,isDefined:Za,slice:F,foldl:$a,foldr:wa,map:D,
filter:Nb,indexOf:ab,lastIndexOf:Ob,zip:bb,sort:cb,nub:Pa,maybe:Pb,compare:Qb,compose:Rb,compose1:Sb,call:S,id:la,flip:db,cons:G,consJoin:eb,replicate:fb,negate:Tb,null_:gb,elem:Qa,isSpace:hb,isUpper:Ub,isLower:Vb,isAlpha:ib,isAlphaNum:Wb,isDigit:Xb,isHexDigit:jb,isOctDigit:Yb,digitToInt:kb,range:Fc,extend:z,namespace:Kc,toInteger:uc,fromInteger:La,fromIntegral:vc,fst:Gc,snd:Hc,uncurry:Ic,lookup:Jc});var xa=new Zb;Ra.prototype.toString=$b();Ra.prototype.dataConstructorToString=$b(true);da(Q,[["Just",
"a"],"Nothing"]);da(Fa,["LT","EQ","GT"]);da(ya,[["Left","a"],["Right","b"]]);var za={$:{func:S,fixity:pa(0)},".":{func:Sb,fixity:pa(9)},":":{func:G,fixity:pa(5)}};Array.prototype.resolve=function(){return fa(this)};var P=new mb;z(ma,{data:da,ADT:Ra,record:xa,Maybe:Q,Ordering:Fa,Either:ya,operators:za,infix:ac,infixl:ba,infixr:pa,arr:Oc,op:Qc,str:Pc,ex:Rc,resolve:fa,recurse:P,Recurse:mb,cs:m});Ga.prototype={memoize:false,scrollTo:function(a){this.index=a;this.length=this.input.length-a;return this},
scroll:function(a){this.index+=a;this.length-=a;return this},at:function(a){return this.input.charAt(this.index+a)},substring:function(a,b){return this.input.substring(a+this.index,(b||this.length)+this.index)},substr:function(a,b){return this.input.substring(a+this.index,b||this.length)},toString:function(){var a=this.substring(0);return"PS at "+this.index+" "+(a.length?'"'+a+'"':"Empty")},getCached:function(a){if(this.memoize)if(a=this.cache[a])if(a=a[this.index]){this.index=a.index;this.length=
a.length;return a}},putCached:function(a,b,c){if(!this.memoize)return false;c.index=this.index;c.length=this.length;var d=this.cache[a];d||(d=this.cache[a]={});d[b]=c}};var Uc=E(y),zc=cc,ub=dc;P=ub;var kc=0,Kb=function(a,b){function c(d,f,e){return{func:a,args:[d,f,function(h){return h.success?b(d,f,e):e(h)}]}}c.constructor=q;return c},k=function(){function a(c,d,f){var e={},h=1,j=b.length,i=b[0];for(e.scope=d;h<j;++h)i=Kb(i,b[h]);return i(c,e,f)}var b=D(nb,arguments);a.constructor=q;return a},W=
Rb(t,rb),n=gc,Ac=n,Ba=hc,Ea=Ba,na=function(a,b,c){return Ha(Ba(a,b),c)},T=function(a,b,c,d){return Ha(Ha(Ba(a,b),c),d)},mc=Ea,Ya=Kb,Lb=v,qa=jc(false),Ia=jc(true),M=Ta(function(a,b,c,d){if(b.success)return b;c.scrollTo(d);return Aa(b.expecting)}),ha=function(a){return Ta(function(b,c){c=z({},c);c.ast=y;return c})(qa(a),null)},r=tb(function(a,b){if(b.length>0&&b.at(0)==a){b.scroll(1);return E(a)}return Aa(a)}),C=tb(function(a,b){var c=b.at(0);if(b.length>0&&a(c)){b.scroll(1);return E(c)}return Aa(c)}),
V=function(a){return Ta(function(b,c,d,f){c.ast=c.ast.join("");c=z({},c);if(c.success)delete c.expecting;else c.expecting={at:f,expecting:a};if(!c.ast.length)c.ast=y;return c})(sb(D(r,a)),null)},ta=Ta(function(a,b,c,d){if(!b.success){b=z({},b);b.expecting={at:d,expecting:a}}return b}),jd=tb(function(a,b){var c;if(typeof a=="string")if(b.substring(0,a.length)==a){b.scroll(a.length);c=E(a)}else c=Aa(a);else if(a.exec){var d=new RegExp("^"+a.source);c=b.substring(0);d=(d=(d=d.exec(c))&&d[0])&&d.length;
c=c.substr(0,d);if(d){b.scroll(d);c=E(c)}else c=Aa(a.source)}return c});z(za,{"<-":{func:s,fixity:pa(-1)},">>=":{func:qb,fixity:ba(1)},"=<<":{func:db(qb),fixity:pa(1)},">>":{func:Ya,fixity:ba(1)},"*>":{func:Ya,fixity:ba(4)},"<*":{func:ic,fixity:ba(4)},"<$>":{func:Ba,fixity:ba(4)},"<*>":{func:Ha,fixity:ba(4)},"<**>":{func:oa(na)(db(S)),fixity:ba(4)},"<$":{func:function(a,b){return ic(Ac(value),b)},fixity:ba(4)},"<|>":{func:v,fixity:pa(1)},"<?>":{func:ta,fixity:ac(0)}});z(ma,{sequence:lc,run:Tc,Parser:q,
ParseState:Ga,ps:bc,toParser:nb,unexpected:Sa,parsecMap:hc,fmap:Ba,liftM:mc,liftM2:na,liftM3:T,liftA:Ea,liftA2:na,liftA3:T,ap:Ha,parserBind:qb,parserReturn:gc,return_:n,pure:Ac,parserFail:cc,fail:zc,parserZero:dc,mzero:ub,empty:P,parserPlus:v,parserPlusN:Vc,mplus:Lb,do_:k,do2:Kb,bind:s,ret:t,withBound:rb,returnCall:W,getParserState:ec,setParserState:fc,tokens:sb,many:qa,many1:Ia,string:V,char_:r,satisfy:C,label:ta,try_:M,skipMany:ha,match:jd});var X=function(a){return ta(C(function(b){return Qa(b,
a)}),"oneOf("+a+")")},Cb=function(a){return ta(C(function(b){return!Qa(b,a)}),"noneOf("+a+")")},Db=[C,hb,"<?>","space"].resolve();Ea=[ha,Db,"<?>","white space"].resolve();na=[r,"\n","<?>","new-line"].resolve();T=[r,"\t","<?>","tab"].resolve();var xc=[C,Ub,"<?>","uppercase letter"].resolve();Ya=[C,Vb,"<?>","lowercase letter"].resolve();S=[C,Wb,"<?>","letter or digit"].resolve();P=[C,ib,"<?>","letter"].resolve();var Gb=[C,Xb,"<?>","digit"].resolve(),Fb=[C,jb,"<?>","hexadecimal digit"].resolve(),Eb=
[C,Yb,"<?>","octal digit"].resolve();Lb=[C,Mb(true)].resolve();z(ma,{oneOf:X,noneOf:Cb,space:Db,spaces:Ea,newline:na,tab:T,upper:xc,lower:Ya,alphaNum:S,letter:P,digit:Gb,hexDigit:Fb,octDigit:Eb,anyChar:Lb});var ra=oa(function(a,b,c){return k(a,s("x",c),b,t("x"))});z(ma,{choice:ga,count:$c,between:ra,option:Ua,optionMaybe:Wc,optional:Xc,skipMany1:Va,sepBy:vb,sepBy1:Wa,endBy:Zc,endBy1:Yc,sepEndBy:oc,sepEndBy1:nc,chainl:bd,chainl1:qc,chainr:ad,chainr1:pc,eof:dd,notFollowedBy:wb,manyTill:ed,lookAhead:fd,
anyToken:cd});da(Ja,[["LanguageDef",{commentStart:String,commentEnd:String,commentLine:String,nestedComments:Boolean,identStart:q,identLetter:q,opStart:q,opLetter:q,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);da(xb,[["TokenParser",{identifier:q,reserved:Function,operator:q,reservedOp:Function,charLiteral:q,stringLiteral:q,natural:q,integer:q,float_:q,naturalOrFloat:q,decimal:q,hexadecimal:q,octal:q,symbol:Function,lexeme:Function,whiteSpace:q,parens:Function,braces:Function,
angles:Function,brackets:Function,squares:Function,semi:q,comma:q,colon:q,dot:q,semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);z(ma,{GenLanguageDef:Ja,GenTokenParser:xb,makeTokenParser:yb});T=X(":!#$%&*+./<=>?@\\^|-~");Ea=Ja.LanguageDef(xa,{commentStart:"",commentEnd:"",commentLine:"",nestedComments:true,identStart:[P,"<|>",r("_")].resolve(),identLetter:[S,"<|>",X("_'")].resolve(),opStart:T,opLetter:T,reservedOpNames:[],reservedNames:[],caseSensitive:true});na=Ja.LanguageDef(xa,
{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,identStart:P,identLetter:[S,"<|>",X,"_'"].resolve(),opStart:T,opLetter:T,reservedOpNames:[],reservedNames:[],caseSensitive:true});S=Ja.LanguageDef(xa,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:true,identStart:P,identLetter:[S,"<|>",X,"_'"].resolve(),opStart:T,opLetter:T,reservedOpNames:[],reservedNames:[],caseSensitive:false});P=na.update({reservedOpNames:["::","..","=","\\","|","<-","->","@","~","=>"],
reservedNames:["let","in","case","of","if","then","else","data","type","class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Bc=P.update({identLetter:[P.identLetter,"<|>",r("#")].resolve(),reservedNames:P.reservedNames.concat(["foreign","import","export","primitive","_ccall_","_casm_","forall"])}),Cc=S.update({reservedNames:["case","class","default","extends","import","in","let","new","of","package"],caseSensitive:true});z(ma,
{emptyDef:Ea,haskellStyle:na,javaStyle:S,haskellDef:Bc,mondrianDef:Cc,getHaskell:function(){return yb(Bc)},getMondrian:function(){return yb(Cc)}});da(Ib,["AssocNone","AssocLeft","AssocRight"]);da(Jb,[["Infix",Function,Ib],["Prefix",Function],["Postfix",Function]]);z(ma,{Assoc:Ib,Operator:Jb,buildExpressionParser:id})})();
